{% extends "base.html" %}
{% block content %}

<body class="interview-page">

<div class="page-card wide">

    <h1 style="text-align:center;">Camera & Microphone Setup</h1>
    <p style="text-align:center; max-width:600px; margin:0 auto;">
        Please enable your camera and microphone so that IntervYou can analyze your
        communication, confidence, and facial expressions during the interview.
    </p>

    <div class="two-col" style="margin-top:30px;">

        <!-- LEFT — Live Camera Preview -->
        <div id="camera-box">
            <video id="preview" autoplay playsinline></video>

            <div style="margin-top:15px;">
                <button class="btn" id="enable">Enable Camera & Mic</button>
                <button class="btn-outline" id="disable">Disable</button>
            </div>

            <p id="status" class="muted">Camera is off.</p>
        </div>

        <!-- RIGHT — Illustration -->
        <div style="text-align:center;">
            <img src="{{ url_for('static', filename='images/illustrations/interview_ai.png') }}"
                 alt="AI Interview Illustration"
                 style="width:100%; max-width:360px;">
        </div>

    </div>

    <div style="text-align:center; margin-top:30px;">
        <a href="/interview" class="btn" style="width:260px;">Proceed to Interview →</a>
    </div>

</div>

<script>
let stream;

document.getElementById("enable").onclick = async () => {
    stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
    document.getElementById("preview").srcObject = stream;
    document.getElementById("status").textContent = "Camera & microphone enabled.";
};

document.getElementById("disable").onclick = () => {
    if (stream){
        stream.getTracks().forEach(t => t.stop());
    }
    document.getElementById("preview").srcObject = null;
    document.getElementById("status").textContent = "Camera is off.";
};
</script>

</body>

{% endblock %}
